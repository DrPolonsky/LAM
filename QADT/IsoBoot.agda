{-# OPTIONS --type-in-type #-}

open import Logic
open import Lifting
open import Datatypes
open import Predicates using (๐)
open import Relations.Core using (Rel)

-- Bootstrapping isomorphisms
module QADT.IsoBoot where

data ๐ (V : Set) : Set where
  ๐โ : V โ ๐ V
  โฅโ : ๐ V
  โคโ : ๐ V
  รโ : ๐ V โ ๐ V โ ๐ V
  โโ : ๐ V โ ๐ V โ ๐ V
  โโ : ๐ V โ ๐ V โ ๐ V

Sub : Set โ Set โ Set
Sub V W = V โ ๐ W

_[_] : โ {V W : Set} โ ๐ V โ Sub V W โ ๐ W
๐โ x [ ฯ ] = ฯ x
โฅโ [ ฯ ] = โฅโ
โคโ [ ฯ ] = โคโ
รโ A B [ ฯ ] = รโ (A [ ฯ ]) (B [ ฯ ])
โโ A B [ ฯ ] = โโ (A [ ฯ ]) (B [ ฯ ])
โโ A B [ ฯ ] = โโ (A [ ฯ ]) (B [ ฯ ])

data ๐* {V : Set} : ๐ V โ ๐ V โ Set where
  ๐* : โ v โ ๐* (๐โ v) (๐โ v)
  โฅ* : ๐* โฅโ โฅโ
  โค* : ๐* โคโ โคโ
  ร* : โ {A0 A1 : ๐ V} (A* : ๐* A0 A1) {B0 B1 : ๐ V} (B* : ๐* B0 B1) โ ๐* (รโ A0 B0) (รโ A1 B1)
  โ* : โ {A0 A1 : ๐ V} (A* : ๐* A0 A1) {B0 B1 : ๐ V} (B* : ๐* B0 B1) โ ๐* (โโ A0 B0) (โโ A1 B1)
  โ* : โ {A0 A1 : ๐ V} (A* : ๐* A0 A1) {B0 B1 : ๐ V} (B* : ๐* B0 B1) โ ๐* (โโ A0 B0) (โโ A1 B1)

Sub* : โ {V W : Set} โ Rel (Sub V W) (Sub V W)
Sub* ฯ ฯ = โ v โ ๐* (ฯ v) (ฯ v)

_[_]* : โ {V W : Set} โ (A : ๐ V) โ {ฯ ฯ : Sub V W} โ (ฯฯ : Sub* ฯ ฯ) โ ๐* (A [ ฯ ]) (A [ ฯ ])
๐โ x [ ฯฯ ]* = ฯฯ x
โฅโ [ ฯฯ ]* = โฅ*
โคโ [ ฯฯ ]* = โค*
รโ A B [ ฯฯ ]* = ร* (A [ ฯฯ ]*) (B [ ฯฯ ]*)
โโ A B [ ฯฯ ]* = โ* (A [ ฯฯ ]*) (B [ ฯฯ ]*)
โโ A B [ ฯฯ ]* = โ* (A [ ฯฯ ]*) (B [ ฯฯ ]*)

refl๐* : โ {V : Set} (A : ๐ V) โ ๐* A A
refl๐* (๐โ x) = ๐* x
refl๐* โฅโ = โฅ*
refl๐* โคโ = โค*
refl๐* (รโ A B) = ร* (refl๐* A) (refl๐* B)
refl๐* (โโ A B) = โ* (refl๐* A) (refl๐* B)
refl๐* (โโ A B) = โ* (refl๐* A) (refl๐* B)

idSub : โ {V W : Set} (ฯ : Sub V W) โ Sub* ฯ ฯ
idSub ฯ x = refl๐* (ฯ x)

SetEnv : Set โ Set
SetEnv V = V โ Set

โฆ_โง : โ {V} โ ๐ V โ SetEnv V โ Set
โฆ ๐โ x โง ฯ = ฯ x
โฆ โฅโ โง ฯ = โฅ
โฆ โคโ โง ฯ = โค
โฆ รโ A B โง ฯ = โฆ A โง ฯ ร โฆ B โง ฯ
โฆ โโ A B โง ฯ = โฆ A โง ฯ โ โฆ B โง ฯ
โฆ โโ A B โง ฯ = Rel (โฆ A โง ฯ) (โฆ B โง ฯ)

RelEnv : โ {V : Set} โ Rel (SetEnv V) (SetEnv V)
RelEnv {V} ฯ0 ฯ1 = โ v โ Rel (ฯ0 v) (ฯ1 v)

โฆ_โง* : โ {V} {A B : ๐ V} โ ๐* A B โ {ฯ0 ฯ1 : SetEnv V} (ฯ* : RelEnv ฯ0 ฯ1)
           โ Rel (โฆ A โง ฯ0) (โฆ B โง ฯ1)
โฆ ๐* v โง* ฯ* = ฯ* v
โฆ โฅ* โง* ฯ* ()
โฆ โค* โง* ฯ* _ _ = โค
โฆ ร* A* B* โง* ฯ* (a0 , b0) (a1 , b1) = โฆ A* โง* ฯ* a0 a1 ร โฆ B* โง* ฯ* b0 b1
โฆ โ* A* B* โง* ฯ* (in1 a0) (in1 a1) = โฆ A* โง* ฯ* a0 a1
โฆ โ* A* B* โง* ฯ* (in1 _) (in2 _) = โฅ
โฆ โ* A* B* โง* ฯ* (in2 _) (in1 _) = โฅ
โฆ โ* A* B* โง* ฯ* (in2 b0) (in2 b1) = โฆ B* โง* ฯ* b0 b1
โฆ โ* A* B* โง* ฯ* i0 i1 = โ {x0} {y0} (xy0 : i0 x0 y0) {x1} {y1} (xy1 : i1 x1 y1)
                           โ Rel (โฆ A* โง* ฯ* x0 x1) (โฆ B* โง* ฯ* y0 y1)



-- โฆ_โงRel : โ {V} (A : ๐ V) {ฯ0 ฯ1 : SetEnv V}
--           โ RelEnv ฯ0 ฯ1 โ Rel (โฆ A โงSet ฯ0) (โฆ A โงSet ฯ1)
-- โฆ ๐โ x โงRel ฯ* = ฯ* x
-- โฆ โฅโ โงRel ฯ* ()
-- โฆ โคโ โงRel ฯ* _ _ = โค
-- โฆ รโ A B โงRel ฯ* (a0 , b0) (a1 , b1) = โฆ A โงRel ฯ* a0 a1 ร โฆ B โงRel ฯ* b0 b1
-- โฆ โโ A B โงRel ฯ* (in1 a0) (in1 a1) = โฆ A โงRel ฯ* a0 a1
-- โฆ โโ A B โงRel ฯ* (in1 _) (in2 _) = โฅ
-- โฆ โโ A B โงRel ฯ* (in2 _) (in1 _) = โฅ
-- โฆ โโ A B โงRel ฯ* (in2 b0) (in2 b1) = โฆ B โงRel ฯ* b0 b1
-- โฆ โโ A B โงRel ฯ* i0 i1 =
--   โ {x0} {y0} (xy0 : i0 x0 y0) {x1} {y1} (xy1 : i1 x1 y1)
--     โ Rel (โฆ A โงRel ฯ* x0 x1) (โฆ B โงRel ฯ* y0 y1)

{-
โฆ_โง*Setโ : โ {V} {A B : ๐ V} โ ๐* A B โ (ฯ : SetEnv V) โ Rel (โฆ A โงSet ฯ) (โฆ B โงSet ฯ)
โฆ ๐* v โง*Setโ ฯ = {!   !}
โฆ โฅ* โง*Setโ ฯ = {!   !}
โฆ โค* โง*Setโ ฯ = {!   !}
โฆ ร* A Aโ โง*Setโ ฯ = {!   !}
โฆ โ* A Aโ โง*Setโ ฯ = {!   !}



โฆ_โง*Sub : โ {V W : Set} {A B : ๐ V} โ ๐* A B โ {ฯ0 ฯ1 : Sub V W} (ฯ* : Sub* ฯ0 ฯ1) (ฯ : SetEnv W)
           โ Rel (โฆ A [ ฯ0 ] โงSet ฯ) (โฆ B [ ฯ1 ] โงSet ฯ)
โฆ AB โง*Sub ฯ* ฯ = {! AB [ ]  !}

eq : โ {V : Set} (A : ๐ V) {ฯ : SetEnv V} โ Rel (โฆ A โงSet ฯ) (โฆ A โงSet ฯ)
eq A {ฯ} = let
    A๐โ = A [ ๐โ ]
    A[๐*] = A [ idSub ๐โ ]*
    reflA = refl๐* A
    reflA* = โฆ refl A โง*Set (idSub ๐ฬโ)
  in ?


-- โฆ_โง*Rel : โ {V} {A B : ๐ V} (R : ๐* A B) โ {ฯ0 ฯ1 : SetEnv V} (ฯ* : RelEnv ฯ0 ฯ1)
--            โ (e0 : SetEnvElem ฯ0) (e1 : SetEnvElem ฯ1)
--            โ RelEnvProof ฯ* e0 e1 โ โฆ R โง*Set ฯ* e0 e1

-- โฆ_โง*Rel : โ {V} {A0 A1 : ๐ V} (A* : ๐* A0 A1) โ {B0 B1 : ๐ V} (B* : ๐* B0 B1)
--             โ  ๐* A B โ (ฯ : SetEnv V) โ Rel (โฆ A โงSet ฯ) (โฆ B โงSet ฯ)

SetEnv๐ : โ V โ SetEnv V
SetEnv๐ V = ฮป v โ ๐ V

RelEnv๐* : โ V โ RelEnv (SetEnv๐ V) (SetEnv๐ V)
RelEnv๐* V = ฮป v โ ๐*

T๐โฐ : โ (A : ๐ โฅ) โ Rel (โฆ A โงSet โ) (โฆ A โงSet โ)
T๐โฐ A = โฆ A โงRel ฮป ()

T๐ : โ {V} (A : ๐ V) (ฯ : SetEnv V) โ Rel (โฆ A โงSet ฯ) (โฆ A โงSet ฯ)
T๐ A ฯ = {!   !}

-- Id๐ ฯ = ๐*
--
--
-- Eq๐ : โ {V} โ Rel (๐ V) (๐ V)
-- Eq๐ {V} = {!   !}

-- SetEnvElem : โ {V} โ SetEnv V โ Set
-- SetEnvElem {V} ฯ = โ v โ ฯ v
--
-- RelEnvProof : โ {V} {ฯ0 ฯ1 : SetEnv V} โ RelEnv ฯ0 ฯ1 โ SetEnvElem ฯ0 โ SetEnvElem ฯ1 โ Set
-- RelEnvProof {V} {ฯ0} {ฯ1} ฯ* e0 e1 = โ (v : V) โ ฯ* v (e0 v) (e1 v)






-- the end

-- โฆ_โง*Set : โ {V} {A B : ๐ V} โ ๐* A B โ (ฯ : SetEnv V) (idฯ : RelEnv ฯ ฯ) โ Rel (โฆ A โงSet ฯ) (โฆ B โงSet ฯ)
-- โฆ ๐* v โง*Set ฯ a b = {!   !}
-- โฆ โค* โง*Set ฯ a b = {!   !}
-- โฆ ร* A* A*โ โง*Set ฯ a b = {!   !}
-- โฆ โ* A* A*โ โง*Set ฯ a b = {!   !}

-}
