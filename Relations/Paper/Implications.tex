\section{Implications}
\label{sec:Implications}

\newenvironment{counterexample}[1][]{%
    \refstepcounter{CEcounter} % Increment the counter
    \noindent \scriptsize\textbf{{\theCEcounter } }  #1\par
}

% From the perspective of programming language theory, the two properties of abstract rewriting 
% systems that are most interesting are $\SN$ and $\CR$. The following hierarchies 
% show chains of implications starting from these properties.
As discussed in Subsection \ref{subsec:def} we put forward $\RP$ as an alternative for $\Inc$. It is through examining $\RP$ that 
we came to the below definitions. 

\begin{definition}\label{def:mf}  Let $A$ and $R$ be as above, and let $a \in A$.
    \begin{description}
        \item[$a \in \MF_R$] \emph{$a$ is a minimal form} if $a \mstep b \implies b \mstep a$ for any $b \in A$.
        \item[$a \in \WM_R$] \emph{$a$ is weakly minimalizing} if $a \mstep b$ for some $b \in \MF_R$.
        \item[$a \in \SM_R$]  \emph{$a$ is strongly minimalizing} if either $a \in MF_R$, or every element one $R$ step from $a$ is also strongly minimalizing.
        \item[$a \in \MP_R$] \emph{$a$ has the minimal form property} if $c \bmstep a \mstep b \implies c \mstep b$ for any $b \in \MF$.

    \end{description}
\end{definition}

\sacomment{Need to relate SM and SMseq. Probably define SMseq and metion 
we can only prove this for SMseq.}
\begin{proposition}\label{prop:SMRP}
    $SM \leftrightarrow RP \land BP$
\end{proposition}
\begin{proof}
    See,\\ \verb|RP∧BP→SMseq : R isRP → R isBP → ∀ {x : A} → SMseq R x| \\ \verb|RisSMseq→RisRP : (∀ {x : A} → SMseq R x) → R isRP|
    \\ \verb|RisSMseq→RisBP : (∀ {x : A} → SMseq R x) → R isBP| in \texttt{ARS-Implications.agda}.
\end{proof}

Trivially, the following also holds. 
\begin{proposition}\label{prop:nftomf}
    $a\in NF_R \implies a \in MF_R$ 
\end{proposition}    
\begin{proof}
    See, \verb|NF ⊆ MF : ∀x → NFx → MFx| in \texttt{ARS-Implications.agda}.
\end{proof}

With these minimal definitions we can see the taxonomy of concepts that relate to termination and confluence.

\begin{center}

    \begin{tikzpicture}[auto,
      arrowstyle/.style={->, line width=1pt, >={Latex[length=3mm, width=2mm]}, shorten >=2pt}]
      % A box style
      \tikzstyle{boxnode} = [draw, rectangle, text centered,minimum width=1.2cm, inner sep=3pt]
  
      % Place the nodes vertically (top to bottom)
      \node (Confluent) [boxnode] at (-4,0) {$\CR$};
      \node (RP)        [boxnode, right=.5cm of Confluent] {$\MP$};
      \node (WN)        [boxnode, right=.5cm of RP] {$\NP$};
      \node (UN)        [boxnode, right=.5cm of WN] {$\UNto$};
  
      % Draw arrows downwards
      \draw[arrowstyle] (Confluent) -- (RP);
      \draw[arrowstyle] (RP) -- (WN);
      \draw[arrowstyle] (WN) -- (UN);
   
        
        % Define the nodes
        \node (NF) [boxnode] at (3,0) {$\NF$};
        \node (MF) [boxnode] at (3,-1) {$\MF$};
        \node (SN) [boxnode] at (5,0) {$\SN$};
        \node (SR) [boxnode] at (5,-1) {$\SM$};
        \node (WN) [boxnode] at (7,0) {$\WN$};
        \node (WR) [boxnode] at (7,-1) {$\WM$};
        
        % Draw the arrows to form a diamond
        \draw [arrowstyle] (NF) -- (SN);
        \draw [arrowstyle] (NF) -- (MF);
        \draw [arrowstyle] (MF) -- (SR);
        \draw [arrowstyle] (SN) -- (WN);
        \draw [arrowstyle] (SN) -- (SR);
        \draw [arrowstyle] (WN) -- (WR);
        \draw [arrowstyle] (SR) -- (WR);
      \end{tikzpicture}
\end{center}

The implications in this diagram are formalized in \texttt{ARS-Implications.agda}. The classical property of being minimally decidable is 
required to complete the implcation from $\SN$ to $\WN$, as can be seen in our formalization

\verb|SNdec→WN : (~R R) isMinDec → SN ⊆ WN| 

\sacomment{Are we going to define this property here or elsewhere?}

The isMinDec property states that all elements either have a relation to some other element, or 
there is no other element to which they have a relation. If the element relates to no other element then it is terminating 
and so trivially $\WN$. If the element does relate to some other element $y \in A$, then we recursively apply our claim to 
$y$ and because we know that we have the property of $\SN$ we must eventually reach a terminating element. 

Similarly, the property of being minimally decidable is required in order to show that $\SM$ implies $\WM$.

We are interested in seeing which combination of properties a relation requires in order to be complete (that is, $\CR$ and $\SN$). 
The following tables show either that a given combination is complete, or the appropriate counterexample which demonstrates why 
those properties do not provide a property higher on the taxonomical hierarchy. 

The first table explores where the properties hold locally, the second explores where the properties hold globally. Counterexamples in the 
first table assume $\WCR$ and in the second table assume $\gWCR$.

\renewcommand*{\thefootnote}{\fnsymbol{footnote}}
\begin{table}[h!]
    \centering
    \caption{Local implications}
    \begin{tabular}{|>{\columncolor{gray!30}}l|c|c|c|c|c|}
    \hline
    \rowcolor{gray!30}     & $\WM$         & $\WN$         & $\SM$             & $\SMandWN$        & $\SN$ \\
    \hline
    $\UNto$ &  CE-\ref{CE:4}, CE-\ref{CE:12}     & CE-\ref{CE:4}, CE-\ref{CE:7}       & CE-\ref{CE:4} , CE-\ref{CE:9}          & CE-\ref{CE:4}, CE-\ref{CE:4}            & $\CR$\footnotemark[1] , $\SN$ \\
    \hline
    $\NP$ & CE-\ref{CE:10},CE-\ref{CE:9}      & $\CR$, CE-\ref{CE:7}    & CE-\ref{CE:11} , CE-\ref{CE:9}          & $\CR$, $\SN$      & $\CR$\footnotemark[2] , $\SN$ \\
    \hline
    $\MP$ & $\CR$ , CE-\ref{CE:9}    & $\CR$, CE-\ref{CE:7}    & $\CR$\footnotemark[2] , CE-\ref{CE:9} & $\CR$, $\SN$      & $\CR$\footnotemark[2] , $\SN$ \\
    \hline
    $\CR$   & $\CR$, CE-\ref{CE:9}     & $\CR$, CE-\ref{CE:7}     & $\CR$, CE-\ref{CE:9}        & $\CR$, $\SN$     & $\CR$ , $\SN$ \\
    \hline
    
    \end{tabular}
\end{table}
\begin{table}[h!]
    \centering
    \caption{Global implications}
    \begin{tabular}{|>{\columncolor{gray!30}}l|c|c|c|c|c|}
    \hline
    \rowcolor{gray!30}     & $\WM$         & $\WN$         & $\SM$             & $\SMandWN$        & $\SN$ \\
    \hline
    $\UNto$ &  CE-\ref{CE:2}, CE-\ref{CE:9}     & $\CR$, CE-\ref{CE:7}    & $\CR$\footnotemark[1] , CE-\ref{CE:9}          & $\CR$, $\SN$      & $\CR$\footnotemark[2] , $\SN$ \\
    \hline
    $\NP$ & CE-\ref{CE:3} , CE-\ref{CE:9}      & $\CR$, CE-\ref{CE:7}    & $\CR$\footnotemark[1] , CE-\ref{CE:9}          & $\CR$, $\SN$      & $\CR$\footnotemark[2] , $\SN$ \\
    \hline
    $\MP$ & $\CR$ , CE-\ref{CE:9}    & $\CR$, CE-\ref{CE:7}    & $\CR$\footnotemark[2] , CE-\ref{CE:9} & $\CR$, $\SN$      & $\CR$\footnotemark[2] , $\SN$ \\
    \hline
    $\CR$   & $\CR$, CE-\ref{CE:9}     & $\CR$, CE-\ref{CE:7}     & $\CR$, CE-\ref{CE:9}        & $\CR$, $\SN$      & $\CR$ , $\SN$ \\
    \hline
    
    \end{tabular}
\end{table}
\footnotetext[1]{This implication also requires global $\WCR$.}
\footnotetext[2]{This implication also requires either global $\WCR$ or the classical property required to go from 
$\SN \to \WN$ or $\SM \to \WM$.}
\renewcommand*{\thefootnote}{\arabic{footnote}}

\subsection{Counterexamples}\label{subsec:counterexamples}
% Setting up the ce counter 
\newcounter{CEcounter}
\renewcommand{\theCEcounter}{\arabic{CEcounter}}

    \begin{center}
        \begin{tabular}{ccc}  % Three columns per row
            % First Counterexample
            \begin{minipage}{0.3\textwidth}
                \centering
                \begin{counterexample}\label{CE:1}
                    \begin{tikzcd}[row sep=small, column sep=small]
                        a & b \arrow[l] \arrow[r, bend left] & c \arrow[l, bend left] \arrow[r] & d
                    \end{tikzcd} \\
                \end{counterexample}
            \end{minipage}
            &
            % Second Counterexample
            \begin{minipage}{0.3\textwidth}
                \centering
                \begin{counterexample}\label{CE:2}
                    \begin{tikzcd}[row sep=small, column sep=small]
                        a & b \arrow[l] \arrow[r, bend left] & c \arrow[l, bend left] \arrow[r] & d \arrow[loop right]
                    \end{tikzcd} \\
                \end{counterexample}
            \end{minipage}
            &
            % Third Counterexample
            \begin{minipage}{0.3\textwidth}
                \centering
                \begin{counterexample}\label{CE:3}
                    \begin{tikzcd}[row sep=small, column sep=small]
                        a \arrow[loop left] & b \arrow[l] \arrow[r, bend left] & c \arrow[l, bend left] \arrow[r] & d \arrow[loop right]
                    \end{tikzcd} \\
                \end{counterexample}
            \end{minipage}
            \\  % New row
            \\
            
            % Fourth Counterexample
            \begin{minipage}{0.3\textwidth}
                \centering
                \begin{counterexample}\label{CE:4}
                    \begin{tikzcd}[row sep=small, column sep=small]
                        & a \arrow[d] \arrow[dl] \\ e & b \arrow[l] \arrow[r] & c \arrow[r, bend left] & d \arrow[l, bend left]
                    \end{tikzcd} \\
                \end{counterexample}
            \end{minipage}
            &
            % Fifth Counterexample
            % \begin{minipage}{0.3\textwidth}
            %     \centering
            %     \begin{counterexample}\label{CE:5}
            %         \begin{tikzcd}[row sep=small, column sep=small]
            %             d & a \arrow[l, two heads] \arrow[r, two heads] & b \arrow[r, bend left] & c \arrow[l, bend left]
            %         \end{tikzcd} \\
            %     \end{counterexample}
            % \end{minipage}
            
            % Sixth Counterexample - This one shows why UN -> doesn't imply UN
            \begin{minipage}{0.3\textwidth}
                \centering
                \begin{counterexample}\label{CE:un}
                    \begin{tikzcd}[row sep=small, column sep=small]
                        n & c \arrow[l] \arrow[r] & a \arrow[r, bend left] & b \arrow[l, bend left]
                        & d \arrow[l] \arrow[r] & m
                    \end{tikzcd} \\
                \end{counterexample}
            \end{minipage}
        % \\ % New row
        % \\
        &
        \begin{minipage}{0.3\textwidth}
            \centering
            \begin{counterexample}\label{CE:7}
            \begin{tikzcd}[row sep=small, column sep=small]
                f_0 \arrow[r] \arrow[dr] & f_1 \arrow[r] \arrow[d] & f_2 \arrow[dl] \arrow[r] & \dots \arrow[dll] \\
                & n 
            \end{tikzcd} \\
            \end{counterexample}
        \end{minipage}
        \\ % new row
        \\
        
        \begin{minipage}{0.3\textwidth}
            \centering
            \begin{counterexample}\label{CE:8}
            \begin{tikzcd}[row sep=small, column sep=small]
                f_0 \arrow[r] \arrow[d] & f_1 \arrow[r] \arrow[d] & f_2 \arrow[r] \arrow[d] & \dots \arrow[d] \\
                n_0  & n_1  & n_2 & \dots 
            \end{tikzcd} \\
            \end{counterexample}
        \end{minipage}
        
        &
        \begin{minipage}{0.3\textwidth}
            \centering
            \begin{counterexample}\label{CE:9}
            \begin{tikzcd}[row sep=small, column sep=small]
                a \arrow[r, bend left] & b \arrow[l, bend left]
            \end{tikzcd} \\
        \end{counterexample}
    \end{minipage}
    % \\ % New row
    % \\
    &
    \begin{minipage}{0.3\textwidth}
        \centering
        \begin{counterexample}\label{CE:10}
            \begin{tikzcd}[row sep=small, column sep=small]
                d  \arrow[d] \arrow[rr, bend left] & a \arrow[r] \arrow[l]  &  
                b \arrow[r, bend left] & c \arrow[l, bend left] \\  
                f_0 \arrow[r] & f_1 \arrow[r] & f_2 \arrow[r] & \dots  
            \end{tikzcd} \\
        \end{counterexample}
    \end{minipage}
    % New row
    \\
    \\
    \begin{minipage}{0.3\textwidth}
        \centering
        \begin{counterexample}\label{CE:11}
            \begin{tikzcd}[row sep=small, column sep=small]
                c \arrow[r, bend left] & b \arrow[l, bend left]  & a \arrow[l] \arrow[r] 
                & d \arrow[r, bend left] & e \arrow[l, bend left]
            \end{tikzcd} \\
        \end{counterexample}
    \end{minipage}
    &
    &
    \begin{minipage}{0.3\textwidth}
        \centering
        \begin{counterexample}\label{CE:12}
            \begin{tikzcd}[row sep=small, column sep=small]
                c & a \arrow[r, bend left] \arrow[l] & b \arrow[l, bend left]
            \end{tikzcd} \\
        \end{counterexample}
    \end{minipage}
    
    
\end{tabular}
\end{center}

\sacomment{Need to update the tables with appropriate symbols for global and local. Colour for first row and column?}

\sacomment{Rewrite the below to reflect changes to the table.}
The tables show a number of changes when moving from properties holding locally to globally. 
Globally $\WN \land \UNto \implies \CR$ holds whereas it does not locally. Similarly, $\SM \land \WN \implies \SN$ holds 
globally but not locally. 

Theorem 1.2.2 ii in \terese is the claim that $\WN \land \UN \implies \CR$ holds, and we formalize this in


\verb|ii : R isWN × R isUN → R isCR| \footnotemark[3]

We have modestly generalized this theorem by showing that $\WN \land \UNto \implies \CR$ holds (and indeed this is the basis for our proof of the theorem). 
Counterexample \sacomment{REF HERE} shows why this implication cannot hold when the properties are only local. Our proof is in the function:

\verb|UN→∧WN→CR : R isUN→ → R isWN → R isCR| \footnotemark[1]

To show that $\SM \land \WN \implies \SN$ we built on our proof that locally $\SM \land \WN \land \NP \implies \SN$. If $\WN$ applies 
globally then our proof no longer requires the property $\NP$. This progression of proofs can be seen in the functions:

\verb|WN∧NP∧SM→SN : ∀ {x} → WN x → NP x → SM x → SN x| 

\verb|isWN∧SM→SN : R isWN → ∀ {x} → SM x → SN x|

\verb|isWN∧isSM→isSN : R isWN → R isSM → R isSN| \footnotemark[1]


that $\SN$ implies $\SM$, and it is from this implication 
that we produce a new generalization of Newman's lemma. Every relation with the properties 
$\SM$ and $\WCR$ has the property of $\CR$. This holds true both locally and globally as we show in:

\verb|LocalNewmansLemmaRecurrent : R isWCR → SM ⊆ CR| \footnotemark[2]

and \verb|GlobalNewmansLemmaRecurrent : R isWCR → R isSM → R isCR| \footnotemark[2]


\sacomment{We should remember that If global WCR and local SM implies local CR, then if we also have local WN, we get local SN.}