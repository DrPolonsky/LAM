\section{Definitions}
\label{sec:Definitions}
The following definitions are provided to ensure clarity and precision
in our discussion. Each subsection specifies the Agda file(s) which contains formalizations of the given definitions.

\begin{definition}
    An abstract rewrite system (\emph{ARS}) is a structure $\mathcal{A} = (A, R_\alpha)$ where
     $A$ is a set and $R_\alpha$ is a set of binary relations on $A$.
\end{definition}

For the rest of this paper, let $A$ be a fixed set, $R$ be a relation on $A$, and $a \in A$.


% \greyout{We denote by $\tilde R$ the relational converse of $R$ ($(x,y) \in \tilde R \iff (y,x) \in R$),
% and by $R;R'$ the relational composition of $R$ and $R'$.}

\subsection{Closure operators (\texttt{Closure.agda})}

\begin{notation} 
The following notations are standard.
  \begin{enumerate}
    \item $R^r$ denotes the \emph{reflexive closure} of $R$.
    \item $R^s$ denotes the \emph{symmetric closure} of $R$.
    \item $\tclos{R}$ denotes the \emph{transitive closure} of $R$.
    \item $R^* = (R^r)\tclos{}$ denotes the \emph{reflexive-transitive closure} of $R$.
    \item $R^= = (R^s)^*$ denotes the \emph{equivalence relation generated by} $R$.
  \end{enumerate}
\end{notation}




In the context of abstract rewriting, we will often write $a \rstep b$
in place of $(a,b) \in R$.  Similarly, we will write $a \mstep b$ for $(a,b) \in R^*$,
$a \bstep b$ for $(b,a) \in R$.  When the relation $R$ is clear from the context,
we may drop the corresponding subscript.

We next define rewriting-theoretic concepts like confluence and normalization relative to a fixed element of $A$; global versions of these properties are obtained by universal quantification.
\subsection{Normalization (\texttt{Properties.agda})}
\begin{definition} The following definitions relate to normalization. 
  \begin{description}
    \item[\ule{${a \in \NF_R}$}] \emph{$a$ is a normal form} if $(a,b) \notin R$ for any $b \in A$.
    \item[\ule{$a \in \WN_R$}] \emph{$a$ is weakly normalizing} if $a \mstep b$ for some $b \in \NF_R$.
    \item[\ule{$a \in \SN_R$}] \emph{$a$ is strongly normalizing} if $a$ is accessible with respect to the converse relation $\bar{R} = \setof{(y,x) | (x,y) \in R}$ 
    (see Section \ref{sec:Well-foundedness} for the notion of accessibility).
  \end{description}
\end{definition}



\subsection{Confluence (\texttt{Properties.agda})}
\begin{definition} The following definitions relate to confluence.
    \begin{description}
        \item[\ule{$a \in \WCR_R$}] \emph{$a$ is weakly Church-Rosser (or weakly confluent)} if $c \bstep a \rstep b \implies c \mstep d \bmstep b$.
        \item[\ule{$a \in \CR_R$}] \emph{$a$ is Church-Rosser (or confluent)} if $c \bmstep a \mstep b \implies c \mstep d \bmstep b$.
        \item[\ule{$a \in \CRs_R$}] \emph{$a$ is subcommutative} if $c \bmstep a \mstep b \implies c \rrstep d \brstep b$.
        \item[\ule{$a \in \NPe_R$}] \emph{$a$ has the conversion normal form property} if $a \estep b \implies a\mstep b$ for any $b \in \NF$.
        \item[\ule{$a \in \NP_R$}] \emph{$a$ has the normal form property} if $c \bmstep a \mstep b \implies c \mstep b$ for any $b \in \NF$.
        \item[\ule{$a \in \UN_R$}] \emph{$a$ has the unique normal form property} if $a \estep b \implies a \equiv b$  for any $a, b \in \NF$.
        \item[\ule{$a \in \UNto_R$}] \emph{$a$ has the unique normal form property with respect to reduction} if $c \bmstep a \mstep b  \implies b \equiv c$  for any $b, c \in \NF$.
    \end{description}
\end{definition}

\begin{notation}
    For each of the subsets $\mathrm{X}$ defined above we write 
    $R \models \mathbf{X}$ if $\forall a.\; a \in \mathrm{X}_R$. When $R$ is clear from the context, we will write $\gNP$ for $R \models \gNP$, etc.
    That is, for $\mathrm{X} \in \{\WCR , \CR , \NP , \UN, \dots \}$ we write $\mathbf{X}$ for the statement that $x \in \mathrm{X}_R$ for all $x \in A$.
\end{notation}


In \terese $\,\NF$ is used to denote $\NPe$, whereas we have chosen to use $\NF$ to denote the set of normal forms.

\begin{proposition}\hfill
    \begin{enumerate}
        \item $\gNP \iff \gNPe$
        \item $\gUN \implies \gUNto$
    \end{enumerate}
\end{proposition}
\begin{proof} See\footnote{All proofs are formalized in the accompanying Agda code. References within the paper indicate the corresponding function names and their types to facilitate locating the relevant formalizations.} \hfill
    \begin{enumerate}
        \item \verb|NP₌↔NP : R isNP₌ ↔ R isNP| 
        \item \verb|UN→|\texttt{UN}$^{\to}$\verb|: R isUN → R is|\texttt{UN}$^{\to}$ \\ in \texttt{Implications.agda}.
    \end{enumerate}
\end{proof}

\begin{remark}
    The implication $\UNto \implies \UN$ does not hold, as can be seen in Counterexample~\ref{CE:5} in Subsection~\ref{subsec:counterexamples}.
\end{remark}

\subsection{Sequences and Recurrence (\texttt{Properties.agda}, \texttt{Seq.agda})}
The following definitions are key to formalizing Theorem 1.2.3 in \terese.


\begin{definition} \hfill
    \begin{description}
        \item[\ule{$R \models \gInc$}] \emph{$R$ is increasing} if there exists a ``size function'' $|{-}| : A \to \nat$ satisfying, for all $a, b \in A$,
        $(a \rstep b) \implies |a| < |b|$
    \end{description}
\end{definition}

Having a size function that maps to the natural numbers can be computationally taxing to satisfy.
Further, it takes us outside of purely relational theory. The following definitions are for properties which allow us to forgo $\gInc$, for further discussion see Subsection \ref{subsec:def}.
\begin{definition} \label{def:rp} \hfill
    \begin{description}
        \item[\ule{$s : \nat \to A$}] \emph{A sequence $s \in A$} is a function from the natural numbers to $A$.
        \item[\ule{$s$ is $R$-increasing}] \emph{A sequence $s \in A$ is $R$-increasing} if every term is $R$-related to its preceding term.
        \item[\ule{$a$ is an $s$-bound}] if $s (i) \mstep a$ for all $i \in \nat$.
        \item[\ule{$a \in \BP_R$}] \emph{$a$ has the bound property} if for each $R$-increasing sequence $s$ with $s (0) = a$ there exists an $s$-bound.
        \item[\ule{$R \models \gRP$}] \emph{$R$ has the recurrence property} if for every bounded, increasing sequence $s$ with an $s$-bound, there exists an $i \in \nat$ such that
        $s (i) \mstep x \implies x \mstep s (i)$ for all $x\in A$. 
        \item[\ule{$R \models \gRPm$}] \emph{$R$ has the weak recurrence property} if for every increasing sequence $s$ with bound $b$ there exists an $i \in \nat$ such that $b \mstep s (i)$.
    \end{description}
\end{definition}

In \terese $\mathrm{\,Ind}$ is used to denote $\BP$.

\begin{proposition}\hfill
    \begin{enumerate}
        \item $\gInc \implies \gRP$
        \item $\gRP \iff \gRPm$
    \end{enumerate}
\end{proposition}

\begin{proof}
    See, \hfill
    \begin{enumerate}
        \item This is immediate.
        \item \verb|RP-↔RP : R isRP- ↔ (R isRP)|
    \end{enumerate}
    in \texttt{Implications.agda}
\end{proof}

%TODO: Update below to reflect new convenion for proofs and code.
\begin{remark}
    It follows that every relation that is increasing in the sense of \terese $\,$ vacuously satisfies the RP condition.
\end{remark}

\subsection{Finitely branching (\texttt{FinitelyBranching.agda})}

\begin{definition} \hfill
    \begin{description}
        \item[\ule{$a \in \FB$}] \emph{$a$ is finitely branching} if there are finitely many $b \in A$ such that $a \rstep b$.
    \end{description}
\end{definition}

Our Agda formulation of the above definition makes use of the List type constructor.
\verb|FB a = Σ[ xs ∈ List A ] (∀ b → R b a → b ∈List xs)|

$\FB$ is a property that plays an important role in our discussion of well-foundedness (see Section \ref{sec:Well-foundedness}).
